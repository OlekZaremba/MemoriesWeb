<div class="main">
  <div class="content">
    <div class="grades">
      <div class="tile">
        <h2>Przedmioty</h2>

        <!-- Przycisk: Dodaj przedmiot -->
        <div class="teacher-control-buttons">
          <button (click)="openAddSubjectModal()">Dodaj przedmiot</button>
        </div>

        <!-- Tabela przedmiotów -->
        <div class="student-grades-table">
          <table class="subjects-table">
            <thead>
            <tr>
              <th>Przedmiot</th>
              <th>Przypisani nauczyciele</th>
              <th>Przypisz nauczyciela</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let subject of subjects">
              <td>{{ subject.className }}</td>
              <td>
                <div *ngIf="subject.teachers?.length; else brak">
                  <div *ngFor="let t of subject.teachers">
                    {{ t.teacherName }} ({{ t.groupName }})
                  </div>
                </div>
                <ng-template #brak>Brak przypisań</ng-template>
              </td>
              <td>
                <button class="goToGrade" (click)="openAssignTeacherModal(subject.id)">Przypisz</button>
              </td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal: Dodaj przedmiot -->
<div class="modal-backdrop" *ngIf="showAddSubjectModal">
  <div class="modal">
    <h2>Dodaj przedmiot</h2>

    <label>Nazwa przedmiotu:</label>
    <input
      type="text"
      [(ngModel)]="newSubjectName"
      placeholder="Wpisz nazwę przedmiotu"
    />

    <div class="modal-buttons">
      <button (click)="addSubject()">Zapisz</button>
      <button (click)="closeAddSubjectModal()">Anuluj</button>
    </div>
  </div>
</div>

<!-- Modal: Przypisz przedmiot do relacji nauczyciel-klasa -->
<div class="modal-backdrop" *ngIf="showAssignTeacherModal">
  <div class="modal">
    <h2>Przypisz przedmiot nauczycielowi w klasie</h2>

    <label>Relacja (nauczyciel – klasa):</label>
    <select [(ngModel)]="selectedGroupMemberId">
      <option [ngValue]="null" disabled>-- Wybierz relację --</option>
      <option *ngFor="let gm of groupMembers" [ngValue]="gm.groupMemberId">
        {{ gm.teacherName }} – {{ gm.groupName }}
      </option>
    </select>

    <div class="modal-buttons">
      <button (click)="assignSubjectToGroupMember()">Zapisz</button>
      <button (click)="closeAssignTeacherModal()">Anuluj</button>
    </div>
  </div>
</div>

